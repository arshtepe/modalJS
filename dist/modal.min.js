!function(){"use strict";function a(a){var b,c=this;this._handlers={},this._transition=m,this.params=a=a||{},a.useAnimate=!0,void 0!==a.window&&this.setWindow(a.window),h(this),this._resizeHandler=function(){c.isOpen&&(b&&clearTimeout(b),b=setTimeout(function(){e(c)},10))},window.addEventListener("resize",this._resizeHandler,!1)}function b(a,b){void 0!==a.window&&d(a),a._windowHandler=function(d){c.call(b,d,a)},b.addEventListener("click",a._windowHandler,!1)}function c(a,b){var c=a.target,d=b.params.opt_closeButtonCls;if(k(c,d))return b.hide();for(;c!==this;){if(k(c,d))return void b.hide();c=c.parentNode}}function d(a){a&&a.window&&a.window.removeEventListener("click",a._windowHandler)}function e(a){a.setEndAnimationPostition(),a.params.useAnimate&&i(a.window,l)}function f(a){return a.parentNode.removeChild(a)}function g(a){return"object"==typeof a&&1===a.nodeType&&"object"==typeof a.style&&"object"==typeof a.ownerDocument}function h(a){var b=document.createElement("div");b.className="modal-overlay",a._hideHandler=function(){return a.params.opt_isOverlayClickHide?a.hide():void 0},b.addEventListener("click",a._hideHandler,!1),a.overlay=document.body.appendChild(b)}function i(a,b){for(var c=a.className.trim().split(" "),d=c.length;d;d--)if(c[d]==b)return;c.push(b),a.className=c.join(" ")}function j(a,b){for(var c=a.className.trim().split(" "),d=0;d<c.length;d++)c[d]==b&&c.splice(d--,1);a.className=c.join(" ")}function k(a,b){for(var c=a.className.trim().split(" "),d=0;d<c.length;d++)if(c[d]==b)return!0;return!1}var l="modal-window-animate",m={getSupported:function(){var a=this.supportedVal;if(a)return a;var b,c=document.createElement("fakeelement"),d={OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(b in d)if(void 0!==c.style[b])return this.supportedVal=d[b];return void 0!==c.style.transition?this.supportedVal="transitionend":!1},end:function(a,b){var c=this.getSupported();return c?void a.addEventListener(c,function d(){a.removeEventListener(c,d),b()}):(b(),!1)}};a.prototype.VERSION=[1,0,5],a.prototype.on=function(a,b){this._handlers[a]||(this._handlers[a]=[]),this._handlers[a].push(b)},a.prototype.off=function(a,b){var c=this._handlers[a];if(c){b||delete this._handlers[a];for(var d=0;d<_handlers.length;d++)if(c[d]==b)return void c.splice(d,1)}},a.prototype.emit=function(a){var b=this,c=this._handlers[a],d=arguments;c&&setTimeout(function(){c.forEach(function(a){a.call(b,[].slice.call(d,2))})},0)},a.prototype.setStartAnimationPosition=function(){this.window.style.top=-this.window.clientHeight+"px"},a.prototype.setEndAnimationPostition=function(){var a=this.window,b=(window.innerHeight-a.offsetHeight)/2,c=(window.innerWidth-a.offsetWidth)/2;a.style.top=b+"px",a.style.left=c+"px"},a.prototype.setWindow=function(a){if(!g(a))throw"Incorrect parameter 'window', expected Element";return this.destroyWindow(),void 0!==this.params.opt_closeButtonCls&&b(this,a),this.window=a,a.style.display="none",a.style.position="fixed",a.style.zIndex="100000",this},a.prototype.show=function(){return!this.isOpen&&g(this.window)?(this.emit("show"),this.overlay.style.display="block",this.window.style.display="block",this.setStartAnimationPosition(),e(this),"undefined"!=typeof m&&this.params.useAnimate&&m.getSupported()?m.end(this.window,function(){this.emit("showed")}.bind(this)):this.emit("showed"),this.isOpen=!0):void 0},a.prototype.hide=function(){return this.isOpen&&g(this.window)?(this.emit("hide"),this.overlay.style.display="",this.window.style.display="none",j(this.window,l),this.isOpen=!1,!0):void 0},a.prototype.destroyWindow=function(a){this.hide(),d(this),a===!0&&g(this.window)&&(this.window=f(this.window)),this.window=void 0},a.prototype.destroy=function(a){window.removeEventListener("resize",this._resizeHandler),this.overlay.removeEventListener("click",this._hideHandler),this.destroyWindow(a),this.off("show"),this.off("hide"),f(this.overlay),this.overlay=void 0},window.ModalJS=a}();